!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Sodium",[],e):"object"==typeof exports?exports.Sodium=e():t.Sodium=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=21)}([function(t,e,n){"use strict";function r(t,e){return t<e?-1:t===e?0:1}function o(t,e){return t===e}function i(t){return null===t?"COLLECTION_NULL":a(t)?"COLLECTION_UNDEFINED":c(t)?"$s"+t:"$o"+t.toString()}function s(t,n){if(void 0===n&&(n=","),null===t)return"COLLECTION_NULL";if(a(t))return"COLLECTION_UNDEFINED";if(c(t))return t.toString();var r="{",o=!0;for(var i in t)e.has(t,i)&&(o?o=!1:r+=n,r=r+i+":"+t[i]);return r+"}"}function u(t){return"function"==typeof t}function a(t){return void 0===t}function c(t){return"[object String]"===Object.prototype.toString.call(t)}function l(t){return u(t)?function(e,n){return-1*t(e,n)}:function(t,e){return t<e?1:t===e?0:-1}}function f(t){return function(e,n){return 0===t(e,n)}}var p=Object.prototype.hasOwnProperty;e.has=function(t,e){return p.call(t,e)},e.defaultCompare=r,e.defaultEquals=o,e.defaultToString=i,e.makeString=s,e.isFunction=u,e.isUndefined=a,e.isString=c,e.reverseCompareFunction=l,e.compareToEquals=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),o=function(){function t(e,n){this.rank=e,this.action=n,this.seq=t.nextSeq++}return t.prototype.toString=function(){return this.seq.toString()},t.nextSeq=0,t}();e.Entry=o;var i=function(){function t(){this.inCallback=0,this.toRegen=!1,this.prioritizedQ=new r.PriorityQueue(function(t,e){return t.rank.rank<e.rank.rank?1:t.rank.rank>e.rank.rank?-1:t.seq<e.seq?1:t.seq>e.seq?-1:0}),this.entries=new r.Set(function(t){return t.toString()}),this.lastQ=[],this.postQ=null}return t.prototype.requestRegen=function(){this.toRegen=!0},t.prototype.prioritized=function(t,e){var n=new o(t,e);this.prioritizedQ.enqueue(n),this.entries.add(n)},t.prototype.last=function(t){this.lastQ.push(t)},t.prototype.post=function(t,e){for(null==this.postQ&&(this.postQ=[]);this.postQ.length<=t;)this.postQ.push(null);var n=this.postQ[t],r=null===n?e:function(){n(),e()};this.postQ[t]=r},t.prototype.checkRegen=function(){if(this.toRegen){this.toRegen=!1,this.prioritizedQ.clear();for(var t=this.entries.toArray(),e=0;e<t.length;e++)this.prioritizedQ.enqueue(t[e])}},t.prototype.isActive=function(){return!!t.currentTransaction},t.prototype.close=function(){for(;;){if(this.checkRegen(),this.prioritizedQ.isEmpty())break;var e=this.prioritizedQ.dequeue();this.entries.remove(e),e.action()}for(var n=0;n<this.lastQ.length;n++)this.lastQ[n]();if(this.lastQ=[],null!=this.postQ){for(var n=0;n<this.postQ.length;n++)if(null!=this.postQ[n]){var r=t.currentTransaction;try{if(n>0){t.currentTransaction=new t;try{this.postQ[n](),t.currentTransaction.close()}catch(e){throw t.currentTransaction.close(),e}}else t.currentTransaction=null,this.postQ[n]();t.currentTransaction=r}catch(e){throw t.currentTransaction=r,e}}this.postQ=null}},t.onStart=function(e){t.onStartHooks.push(e)},t.run=function(e){var n=t.currentTransaction;if(null===n){if(!t.runningOnStartHooks){t.runningOnStartHooks=!0;try{for(var r=0;r<t.onStartHooks.length;r++)t.onStartHooks[r]()}finally{t.runningOnStartHooks=!1}}t.currentTransaction=new t}try{var o=e();return null===n&&(t.currentTransaction.close(),t.currentTransaction=null),o}catch(e){throw null===n&&(t.currentTransaction.close(),t.currentTransaction=null),e}},t.currentTransaction=null,t.onStartHooks=[],t.runningOnStartHooks=!1,t}();e.Transaction=i},function(t,e,n){"use strict";function r(){return s}function o(t){f=t}function i(t,e){if(!e.contains(t.id)){console.log(t.descr()),e.add(t.id);for(var n=t.children(),r=0;r<n.length;r++)i(n[r],e)}}Object.defineProperty(e,"__esModule",{value:!0});var s=0;e.getTotalRegistrations=r;var u=function(){function t(t,e){if(this.registered=!1,this.deregister_=null,null===t)throw new Error("null origin!");this.origin=t,this.register_=e}return t.prototype.register=function(t){var e=this;this.registered||(this.registered=!0,null!==this.register_?this.deregister_=this.register_():(this.origin.increment(t),this.deregister_=function(){return e.origin.decrement(t)}))},t.prototype.deregister=function(t){this.registered&&(this.registered=!1,null!==this.deregister_&&this.deregister_())},t}();e.Source=u;var a;!function(t){t[t.black=0]="black",t[t.gray=1]="gray",t[t.white=2]="white",t[t.purple=3]="purple"}(a=e.Color||(e.Color={}));var c=[],l=0,f=!1;e.setVerbose=o,e.describeAll=i;var p=function(){function t(t,e,n){this.targets=[],this.childrn=[],this.visited=!1,this.color=a.black,this.buffered=!1,this.refCountAdj=0,this.name=t,this.rank=e,this.sources=n,this.id=l++}return t.prototype.refCount=function(){return this.targets.length},t.prototype.register=function(t){return this.increment(t)},t.prototype.deregister=function(e){f&&console.log("deregister "+this.descr()+" => "+e.descr()),this.decrement(e),t.collectCycles()},t.prototype.incRefCount=function(t){var e=!1;if(0==this.refCount())for(var n=0;n<this.sources.length;n++)this.sources[n].register(this);return this.targets.push(t),t.childrn.push(this),t.ensureBiggerThan(this.rank)&&(e=!0),s++,e},t.prototype.decRefCount=function(t){f&&console.log("DEC "+this.descr());for(var e=!1,n=0;n<t.childrn.length;n++)t.childrn[n]===this&&t.childrn.splice(n,1);for(var n=0;n<this.targets.length;n++)if(this.targets[n]===t){this.targets.splice(n,1),e=!0;break}if(e){if(0==this.refCount())for(var n=0;n<this.sources.length;n++)this.sources[n].deregister(this);s--}},t.prototype.addSource=function(t){this.sources.push(t),this.refCount()>0&&t.register(this)},t.prototype.ensureBiggerThan=function(t){if(this.rank>t||this.visited)return!1;this.visited=!0,this.rank=t+1;for(var e=0;e<this.targets.length;e++)this.targets[e].ensureBiggerThan(this.rank);return this.visited=!1,!0},t.prototype.descr=function(){var t=null;switch(this.color){case a.black:t="black";break;case a.gray:t="gray";break;case a.white:t="white";break;case a.purple:t="purple"}for(var e=this.id+" "+this.name+" ["+this.refCount()+"/"+this.refCountAdj+"] "+t+" ->",n=this.children(),r=0;r<n.length;r++)e=e+" "+n[r].id;return e},t.prototype.children=function(){return this.childrn},t.prototype.increment=function(t){return this.incRefCount(t)},t.prototype.decrement=function(t){this.decRefCount(t),0==this.refCount()?this.release():this.possibleRoots()},t.prototype.release=function(){this.color=a.black,this.buffered||this.free()},t.prototype.free=function(){for(;this.targets.length>0;)this.decRefCount(this.targets[0])},t.prototype.possibleRoots=function(){this.color!=a.purple&&(this.color=a.purple,this.buffered||(this.buffered=!0,c.push(this)))},t.collectCycles=function(){t.markRoots(),t.scanRoots(),t.collectRoots()},t.markRoots=function(){for(var t=[],e=0;e<c.length;e++)f&&console.log("markRoots "+c[e].descr()),c[e].color==a.purple?(c[e].markGray(),t.push(c[e])):(c[e].buffered=!1,c[e].color==a.black&&0==c[e].refCount()&&c[e].free());c=t},t.scanRoots=function(){for(var t=0;t<c.length;t++)c[t].scan()},t.collectRoots=function(){for(var t=0;t<c.length;t++)c[t].buffered=!1,c[t].collectWhite();c=[]},t.prototype.markGray=function(){if(this.color!=a.gray){this.color=a.gray;for(var t=this.children(),e=0;e<t.length;e++)t[e].refCountAdj--,f&&console.log("markGray "+this.descr()),t[e].markGray()}},t.prototype.scan=function(){if(f&&console.log("scan "+this.descr()),this.color==a.gray)if(this.refCount()+this.refCountAdj>0)this.scanBlack();else{this.color=a.white,f&&console.log("scan WHITE "+this.descr());for(var t=this.children(),e=0;e<t.length;e++)t[e].scan()}},t.prototype.scanBlack=function(){this.color=a.black;for(var t=this.children(),e=0;e<t.length;e++)t[e].refCountAdj++,f&&console.log("scanBlack "+this.descr()),t[e].color!=a.black&&t[e].scanBlack()},t.prototype.collectWhite=function(){if(this.color==a.white&&!this.buffered){f&&console.log("collectWhite "+this.descr()),this.color=a.black,this.refCountAdj=0;for(var t=this.children(),e=0;e<t.length;e++)t[e].collectWhite();this.free()}},t.NULL=new t("user",1e12,[]),t}();e.Vertex=p},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),i=n(2),s=n(1),u=n(14),a=n(7),c=n(28),l=n(15),f=n(18),p=function(){function t(t){this.listeners=[],this.firings=[],this.vertex=t||new i.Vertex("Stream",0,[])}return t.prototype.getVertex__=function(){return this.vertex},t.prototype.map=function(t){var e=this,n=new h(null),r=o.Lambda1_toFunction(t);return n.vertex=new i.Vertex("map",0,[new i.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){n.send_(r(t))},!1)})].concat(o.toSources(o.Lambda1_deps(t)))),n},t.prototype.mapTo=function(t){var e=this,n=new h(null);return n.vertex=new i.Vertex("mapTo",0,[new i.Source(this.vertex,function(){return e.listen_(n.vertex,function(e){n.send_(t)},!1)})]),n},t.prototype.orElse=function(t){return this.merge(t,function(t,e){return t})},t.prototype.merge_=function(t){var e=this,n=new h,r=new i.Vertex("merge",0,[]);return r.sources.push(new i.Source(this.vertex,function(){return e.listen_(r,function(t){n.send_(t)},!1)})),n.vertex.sources=n.vertex.sources.concat([new i.Source(r,function(){return r.register(n.vertex),function(){r.deregister(n.vertex)}}),new i.Source(t.vertex,function(){return t.listen_(n.vertex,function(t){n.send_(t)},!1)})]),n},t.prototype.coalesce__=function(t){var e=this,n=new h,r=new u.CoalesceHandler(t,n);return n.vertex.sources=n.vertex.sources.concat([new i.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){r.send_(t)},!1)})]).concat(o.toSources(o.Lambda2_deps(t))),n},t.prototype.merge=function(t,e){var n=this;return s.Transaction.run(function(){return n.merge_(t).coalesce__(e)})},t.prototype.filter=function(t){var e=this,n=new h(null),r=o.Lambda1_toFunction(t);return n.vertex=new i.Vertex("filter",0,[new i.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){r(t)&&n.send_(t)},!1)})].concat(o.toSources(o.Lambda1_deps(t)))),n},t.prototype.filterNotNull=function(){var t=this,e=new h(null);return e.vertex=new i.Vertex("filterNotNull",0,[new i.Source(this.vertex,function(){return t.listen_(e.vertex,function(t){null!==t&&e.send_(t)},!1)})]),e},t.prototype.gate=function(t){return this.snapshot(t,function(t,e){return e?t:null}).filterNotNull()},t.prototype.snapshot1=function(t){var e=this,n=new h(null);return n.vertex=new i.Vertex("snapshot1",0,[new i.Source(this.vertex,function(){return e.listen_(n.vertex,function(e){n.send_(t.sampleNoTrans__())},!1)}),new i.Source(t.getVertex__(),null)]),n},t.prototype.snapshot=function(t,e){var n=this,r=new h(null),s=o.Lambda2_toFunction(e);return r.vertex=new i.Vertex("snapshot",0,[new i.Source(this.vertex,function(){return n.listen_(r.vertex,function(e){r.send_(s(e,t.sampleNoTrans__()))},!1)}),new i.Source(t.getVertex__(),null)].concat(o.toSources(o.Lambda2_deps(e)))),r},t.prototype.snapshot3=function(t,e,n){var r=this,s=new h(null),u=o.Lambda3_toFunction(n);return s.vertex=new i.Vertex("snapshot",0,[new i.Source(this.vertex,function(){return r.listen_(s.vertex,function(n){s.send_(u(n,t.sampleNoTrans__(),e.sampleNoTrans__()))},!1)}),new i.Source(t.getVertex__(),null),new i.Source(e.getVertex__(),null)].concat(o.toSources(o.Lambda3_deps(n)))),s},t.prototype.snapshot4=function(t,e,n,r){var s=this,u=new h(null),a=o.Lambda4_toFunction(r);return u.vertex=new i.Vertex("snapshot",0,[new i.Source(this.vertex,function(){return s.listen_(u.vertex,function(r){u.send_(a(r,t.sampleNoTrans__(),e.sampleNoTrans__(),n.sampleNoTrans__()))},!1)}),new i.Source(t.getVertex__(),null),new i.Source(e.getVertex__(),null),new i.Source(n.getVertex__(),null)].concat(o.toSources(o.Lambda4_deps(r)))),u},t.prototype.snapshot5=function(t,e,n,r,s){var u=this,a=new h(null),c=o.Lambda5_toFunction(s);return a.vertex=new i.Vertex("snapshot",0,[new i.Source(this.vertex,function(){return u.listen_(a.vertex,function(o){a.send_(c(o,t.sampleNoTrans__(),e.sampleNoTrans__(),n.sampleNoTrans__(),r.sampleNoTrans__()))},!1)}),new i.Source(t.getVertex__(),null),new i.Source(e.getVertex__(),null),new i.Source(n.getVertex__(),null),new i.Source(r.getVertex__(),null)].concat(o.toSources(o.Lambda5_deps(s)))),a},t.prototype.snapshot6=function(t,e,n,r,s,u){var a=this,c=new h(null),l=o.Lambda6_toFunction(u);return c.vertex=new i.Vertex("snapshot",0,[new i.Source(this.vertex,function(){return a.listen_(c.vertex,function(o){c.send_(l(o,t.sampleNoTrans__(),e.sampleNoTrans__(),n.sampleNoTrans__(),r.sampleNoTrans__(),s.sampleNoTrans__()))},!1)}),new i.Source(t.getVertex__(),null),new i.Source(e.getVertex__(),null),new i.Source(n.getVertex__(),null),new i.Source(r.getVertex__(),null),new i.Source(s.getVertex__(),null)].concat(o.toSources(o.Lambda6_deps(u)))),c},t.prototype.hold=function(t){return new a.Cell(t,this)},t.prototype.holdLazy=function(t){return new f.LazyCell(t,this)},t.prototype.collect=function(t,e){return this.collectLazy(new l.Lazy(function(){return t}),e)},t.prototype.collectLazy=function(t,e){var n=this;return s.Transaction.run(function(){var r=new d,o=r.holdLazy(t),i=n.snapshot(o,e),s=i.map(function(t){return t.a}),u=i.map(function(t){return t.b});return r.loop(u),s})},t.prototype.accum=function(t,e){return this.accumLazy(new l.Lazy(function(){return t}),e)},t.prototype.accumLazy=function(t,e){var n=this;return s.Transaction.run(function(){var r=new d,o=r.holdLazy(t),i=n.snapshot(o,e);return r.loop(i),i.holdLazy(t)})},t.prototype.once=function(){var t=this;return s.Transaction.run(function(){return t.gate(t.mapTo(!1).hold(!0))})},t.prototype.listen=function(t){var e=this;return s.Transaction.run(function(){return e.listen_(i.Vertex.NULL,t,!1)})},t.prototype.listen_=function(t,e,n){var r=this;this.vertex.register(t)&&s.Transaction.currentTransaction.requestRegen();var o=new c.Listener(e,t);if(this.listeners.push(o),!n&&0!=this.firings.length){var i=this.firings.slice();s.Transaction.currentTransaction.prioritized(t,function(){for(var t=0;t<i.length;t++)e(i[t])})}return function(){for(var e=!1,n=0;n<r.listeners.length;n++)if(r.listeners[n]==o){r.listeners.splice(n,1),e=!0;break}e&&r.vertex.deregister(t)}},t}();e.Stream=p;var h=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.setVertex__=function(t){this.vertex=t},e.prototype.send_=function(t){var e=this;if(0==this.vertex.refCount())throw new Error("send() was invoked before listeners were registered");0==this.firings.length&&s.Transaction.currentTransaction.last(function(){e.firings=[]}),this.firings.push(t);for(var n=this.listeners.slice(),r=0;r<n.length;r++)!function(e){var r=n[e].h;s.Transaction.currentTransaction.prioritized(n[e].target,function(){s.Transaction.currentTransaction.inCallback++;try{r(t),s.Transaction.currentTransaction.inCallback--}catch(t){throw s.Transaction.currentTransaction.inCallback--,t}})}(r)},e}(p);e.StreamWithSend=h;var d=function(t){function e(){var e=t.call(this)||this;if(e.assigned__=!1,e.vertex.name="StreamLoop",null===s.Transaction.currentTransaction)throw new Error("StreamLoop/CellLoop must be used within an explicit transaction");return e}return r(e,t),e.prototype.loop=function(t){var e=this;if(this.assigned__)throw new Error("StreamLoop looped more than once");this.assigned__=!0,this.vertex.addSource(new i.Source(t.getVertex__(),function(){return t.listen_(e.vertex,function(t){e.send_(t)},!1)}))},e}(h);e.StreamLoop=d},function(t,e,n){"use strict";function r(t,e,n){for(var r=n||h.defaultEquals,o=t.length,i=0;i<o;i++)if(r(t[i],e))return i;return-1}function o(t,e,n){for(var r=n||h.defaultEquals,o=t.length,i=o-1;i>=0;i--)if(r(t[i],e))return i;return-1}function i(t,e,n){return r(t,e,n)>=0}function s(t,e,n){var o=r(t,e,n);return!(o<0)&&(t.splice(o,1),!0)}function u(t,e,n){for(var r=n||h.defaultEquals,o=t.length,i=0,s=0;s<o;s++)r(t[s],e)&&i++;return i}function a(t,e,n){var r=n||h.defaultEquals;if(t.length!==e.length)return!1;for(var o=t.length,i=0;i<o;i++)if(!r(t[i],e[i]))return!1;return!0}function c(t){return t.concat()}function l(t,e,n){if(e<0||e>=t.length||n<0||n>=t.length)return!1;var r=t[e];return t[e]=t[n],t[n]=r,!0}function f(t){return"["+t.toString()+"]"}function p(t,e){for(var n=0,r=t;n<r.length;n++){if(!1===e(r[n]))return}}var h=n(0);e.indexOf=r,e.lastIndexOf=o,e.contains=i,e.remove=s,e.frequency=u,e.equals=a,e.copy=c,e.swap=l,e.toString=f,e.forEach=p},function(t,e,n){"use strict";var r=n(0),o=function(){function t(t){this.table={},this.nElements=0,this.toStr=t||r.defaultToString}return t.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if(!r.isUndefined(e))return e.value},t.prototype.setValue=function(t,e){if(!r.isUndefined(t)&&!r.isUndefined(e)){var n,o="$"+this.toStr(t),i=this.table[o];return r.isUndefined(i)?(this.nElements++,n=void 0):n=i.value,this.table[o]={key:t,value:e},n}},t.prototype.remove=function(t){var e="$"+this.toStr(t),n=this.table[e];if(!r.isUndefined(n))return delete this.table[e],this.nElements--,n.value},t.prototype.keys=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.key)}return t},t.prototype.values=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.value)}return t},t.prototype.forEach=function(t){for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e],o=t(n.key,n.value);if(!1===o)return}},t.prototype.containsKey=function(t){return!r.isUndefined(this.getValue(t))},t.prototype.clear=function(){this.table={},this.nElements=0},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){var t="{";return this.forEach(function(e,n){t+="\n\t"+e+" : "+n}),t+"\n}"},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";function r(t,e){return new b(t,e)}function o(t){return t instanceof b?t.deps:[]}function i(t){return t instanceof b?t.f:t}function s(t,e){return new T(t,e)}function u(t){return t instanceof T?t.deps:[]}function a(t){return t instanceof T?t.f:t}function c(t,e){return new C(t,e)}function l(t){return t instanceof C?t.deps:[]}function f(t){return t instanceof C?t.f:t}function p(t,e){return new E(t,e)}function h(t){return t instanceof E?t.deps:[]}function d(t){return t instanceof E?t.f:t}function v(t,e){return new L(t,e)}function y(t){return t instanceof L?t.deps:[]}function _(t){return t instanceof L?t.f:t}function m(t,e){return new V(t,e)}function g(t){return t instanceof V?t.deps:[]}function x(t){return t instanceof V?t.f:t}function w(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(new S.Source(r.getVertex__(),null))}return e}Object.defineProperty(e,"__esModule",{value:!0});var S=n(2),b=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda1=b,e.lambda1=r,e.Lambda1_deps=o,e.Lambda1_toFunction=i;var T=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda2=T,e.lambda2=s,e.Lambda2_deps=u,e.Lambda2_toFunction=a;var C=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda3=C,e.lambda3=c,e.Lambda3_deps=l,e.Lambda3_toFunction=f;var E=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda4=E,e.lambda4=p,e.Lambda4_deps=h,e.Lambda4_toFunction=d;var L=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda5=L,e.lambda5=v,e.Lambda5_deps=y,e.Lambda5_toFunction=_;var V=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda6=V,e.lambda6=m,e.Lambda6_deps=g,e.Lambda6_toFunction=x,e.toSources=w},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o=n(2),i=n(1),s=n(15),u=n(3),a=n(16),c=function(){function t(t){this.hasValue=!1,this.value=null,this.cell=t}return t}(),l=function(){function t(){this.f=null,this.f_present=!1,this.a=null,this.a_present=!1}return t}(),f=function(){function t(t,e){var n=this;this.value=t,e?i.Transaction.run(function(){return n.setStream(e)}):(this.str=new u.Stream,this.vertex=new o.Vertex("ConstCell",0,[]))}return t.prototype.setStream=function(t){var e=this;this.str=t;var n=this,r=new o.Source(t.getVertex__(),function(){return t.listen_(n.vertex,function(t){null==n.valueUpdate&&i.Transaction.currentTransaction.last(function(){n.value=n.valueUpdate,n.lazyInitValue=null,n.valueUpdate=null}),n.valueUpdate=t},!1)});this.vertex=new o.Vertex("Cell",0,[r]),this.vertex.register(o.Vertex.NULL),i.Transaction.currentTransaction.last(function(){e.vertex.deregister(o.Vertex.NULL)})},t.prototype.getVertex__=function(){return this.vertex},t.prototype.getStream__=function(){return this.str},t.prototype.sample=function(){var t=this;return i.Transaction.run(function(){return t.sampleNoTrans__()})},t.prototype.sampleNoTrans__=function(){return this.value},t.prototype.sampleLazy=function(){var t=this;return i.Transaction.run(function(){return t.sampleLazyNoTrans__()})},t.prototype.sampleLazyNoTrans__=function(){var t=this,e=new c(t);return i.Transaction.currentTransaction.last(function(){e.value=null!=t.valueUpdate?t.valueUpdate:t.sampleNoTrans__(),e.hasValue=!0,e.cell=null}),new s.Lazy(function(){return e.hasValue?e.value:e.cell.sample()})},t.prototype.map=function(t){var e=this;return i.Transaction.run(function(){return a.Operational.updates(e).map(t).holdLazy(e.sampleLazy().map(r.Lambda1_toFunction(t)))})},t.prototype.lift=function(e,n){var o=r.Lambda2_toFunction(n),i=this.map(function(t){return function(e){return o(t,e)}});return t.apply(i,e,r.toSources(r.Lambda2_deps(n)))},t.prototype.lift3=function(e,n,o){var i=r.Lambda3_toFunction(o),s=function(t){return function(e){return function(n){return i(t,e,n)}}},u=this.map(s);return t.apply(t.apply(u,e),n,r.toSources(r.Lambda3_deps(o)))},t.prototype.lift4=function(e,n,o,i){var s=r.Lambda4_toFunction(i),u=function(t){return function(e){return function(n){return function(r){return s(t,e,n,r)}}}},a=this.map(u);return t.apply(t.apply(t.apply(a,e),n),o,r.toSources(r.Lambda4_deps(i)))},t.prototype.lift5=function(e,n,o,i,s){var u=r.Lambda5_toFunction(s),a=function(t){return function(e){return function(n){return function(r){return function(o){return u(t,e,n,r,o)}}}}},c=this.map(a);return t.apply(t.apply(t.apply(t.apply(c,e),n),o),i,r.toSources(r.Lambda5_deps(s)))},t.prototype.lift6=function(e,n,o,i,s,u){var a=r.Lambda6_toFunction(u),c=function(t){return function(e){return function(n){return function(r){return function(o){return function(i){return a(t,e,n,r,o,i)}}}}}},l=this.map(c);return t.apply(t.apply(t.apply(t.apply(t.apply(l,e),n),o),i),s,r.toSources(r.Lambda6_deps(u)))},t.apply=function(t,e,n){return i.Transaction.run(function(){var r=new l,i=new u.StreamWithSend,c=a.Operational.value(t),f=a.Operational.value(e),p=new o.Source(c.getVertex__(),function(){return c.listen_(i.getVertex__(),function(t){r.f=t,r.f_present=!0,r.a_present&&i.send_(r.f(r.a))},!1)}),h=new o.Source(f.getVertex__(),function(){return f.listen_(i.getVertex__(),function(t){r.a=t,r.a_present=!0,r.f_present&&i.send_(r.f(r.a))},!1)});return i.setVertex__(new o.Vertex("apply",0,[p,h].concat(n||[]))),i.coalesce__(function(t,e){return e}).holdLazy(new s.Lazy(function(){return t.sampleNoTrans__()(e.sampleNoTrans__())}))})},t.switchC=function(t){return i.Transaction.run(function(){var e=t.sampleLazy().map(function(t){return t.sample()}),n=new u.StreamWithSend,r=null,i=a.Operational.value(t),s=new o.Source(i.getVertex__(),function(){var t=null===r?null:a.Operational.value(r).listen_(n.getVertex__(),function(t){return n.send_(t)},!1),e=i.listen_(n.getVertex__(),function(e){r=e,null!==t&&t(),t=a.Operational.value(e).listen_(n.getVertex__(),function(t){return n.send_(t)},!1)},!1);return function(){e(),t()}});return n.setVertex__(new o.Vertex("switchC",0,[s])),n.coalesce__(function(t,e){return e}).holdLazy(e)})},t.switchS=function(t){return i.Transaction.run(function(){var e=new u.StreamWithSend,n=function(t){e.send_(t)},r=new o.Source(t.getVertex__(),function(){var r=t.sampleNoTrans__().listen_(e.getVertex__(),n,!1),o=t.getStream__().listen_(e.getVertex__(),function(t){r(),r=t.listen_(e.getVertex__(),n,!0)},!1);return function(){o(),r()}});return e.setVertex__(new o.Vertex("switchS",0,[r])),e})},t.prototype.listen=function(t){var e=this;return i.Transaction.run(function(){return a.Operational.value(e).listen(t)})},t}();e.Cell=f},function(t,e,n){"use strict";var r=n(0),o=n(4),i=function(){function t(){this.firstNode=null,this.lastNode=null,this.nElements=0}return t.prototype.add=function(t,e){if(r.isUndefined(e)&&(e=this.nElements),e<0||e>this.nElements||r.isUndefined(t))return!1;var n=this.createNode(t);if(0===this.nElements)this.firstNode=n,this.lastNode=n;else if(e===this.nElements)this.lastNode.next=n,this.lastNode=n;else if(0===e)n.next=this.firstNode,this.firstNode=n;else{var o=this.nodeAtIndex(e-1);n.next=o.next,o.next=n}return this.nElements++,!0},t.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},t.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},t.prototype.elementAtIndex=function(t){var e=this.nodeAtIndex(t);if(null!==e)return e.element},t.prototype.indexOf=function(t,e){var n=e||r.defaultEquals;if(r.isUndefined(t))return-1;for(var o=this.firstNode,i=0;null!==o;){if(n(o.element,t))return i;i++,o=o.next}return-1},t.prototype.contains=function(t,e){return this.indexOf(t,e)>=0},t.prototype.remove=function(t,e){var n=e||r.defaultEquals;if(this.nElements<1||r.isUndefined(t))return!1;for(var o=null,i=this.firstNode;null!==i;){if(n(i.element,t))return i===this.firstNode?(this.firstNode=this.firstNode.next,i===this.lastNode&&(this.lastNode=null)):i===this.lastNode?(this.lastNode=o,o.next=i.next,i.next=null):(o.next=i.next,i.next=null),this.nElements--,!0;o=i,i=i.next}return!1},t.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},t.prototype.equals=function(e,n){var o=n||r.defaultEquals;return e instanceof t&&(this.size()===e.size()&&this.equalsAux(this.firstNode,e.firstNode,o))},t.prototype.equalsAux=function(t,e,n){for(;null!==t;){if(!n(t.element,e.element))return!1;t=t.next,e=e.next}return!0},t.prototype.removeElementAtIndex=function(t){if(!(t<0||t>=this.nElements)){var e;if(1===this.nElements)e=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var n=this.nodeAtIndex(t-1);null===n?(e=this.firstNode.element,this.firstNode=this.firstNode.next):n.next===this.lastNode&&(e=this.lastNode.element,this.lastNode=n),null!==n&&(e=n.next.element,n.next=n.next.next)}return this.nElements--,e}},t.prototype.forEach=function(t){for(var e=this.firstNode;null!==e&&!1!==t(e.element);)e=e.next},t.prototype.reverse=function(){for(var t=null,e=this.firstNode,n=null;null!==e;)n=e.next,e.next=t,t=e,e=n;n=this.firstNode,this.firstNode=this.lastNode,this.lastNode=n},t.prototype.toArray=function(){for(var t=[],e=this.firstNode;null!==e;)t.push(e.element),e=e.next;return t},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){return o.toString(this.toArray())},t.prototype.nodeAtIndex=function(t){if(t<0||t>=this.nElements)return null;if(t===this.nElements-1)return this.lastNode;for(var e=this.firstNode,n=0;n<t;n++)e=e.next;return e},t.prototype.createNode=function(t){return{element:t,next:null}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(10),i=n(3),s=n(20),u=n(1),a=function(){function t(){}return t}();e.TimerSystemImpl=a;var c=0,l=function(){function t(t,e){this.t=t,this.sAlarm=e,this.seq=++c}return t}(),f=function(){function t(t){var e=this;this.eventQueue=new o.BSTree(function(t,e){return t.t<e.t?-1:t.t>e.t?1:t.seq<e.seq?-1:t.seq>e.seq?1:0}),u.Transaction.run(function(){e.impl=t,e.tMinimum=0;var n=new s.CellSink(t.now());e.time=n,e.time.listen(function(t){}),u.Transaction.onStart(function(){for(var r=e.tMinimum=Math.max(e.tMinimum,t.now());;){if("break"===function(){var t=null;if(!e.eventQueue.isEmpty()){var o=e.eventQueue.minimum();o.t<=r&&(t=o)}if(null==t)return"break";n.send(t.t),u.Transaction.run(function(){return t.sAlarm.send_(t.t)})}())break}n.send(r)})})}return t.prototype.at=function(t){var e=this,n=null,o=null,s=!1,a=null,c=!1,f=new i.StreamWithSend(null),p=function(){null!==o&&(o(),e.eventQueue.remove(n)),o=null,n=null,s&&(c||(c=!0,a=t.sampleNoTrans__()),null!==a&&(n=new l(a,f),e.eventQueue.add(n),o=e.impl.setTimer(a,function(){e.tMinimum=Math.max(e.tMinimum,a),u.Transaction.run(function(){})})))};return f.setVertex__(new r.Vertex("at",0,[new r.Source(t.getVertex__(),function(){s=!0,c=!1,u.Transaction.currentTransaction.prioritized(f.getVertex__(),p);var e=t.getStream__().listen_(f.getVertex__(),function(t){a=t,c=!0,p()},!1);return function(){s=!1,p(),e()}})])),f},t}();e.TimerSystem=f},function(t,e,n){"use strict";var r=n(4);e.arrays=r;var o=n(22);e.Bag=o.default;var i=n(23);e.BSTree=i.default;var s=n(5);e.Dictionary=s.default;var u=n(13);e.Heap=u.default;var a=n(24);e.LinkedDictionary=a.default;var c=n(8);e.LinkedList=c.default;var l=n(25);e.MultiDictionary=l.default;var f=n(12);e.Queue=f.default;var p=n(26);e.PriorityQueue=p.default;var h=n(11);e.Set=h.default;var d=n(27);e.Stack=d.default;var v=n(0);e.util=v},function(t,e,n){"use strict";var r=n(0),o=n(4),i=n(5),s=function(){function t(t){this.dictionary=new i.default(t)}return t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.add=function(t){return!this.contains(t)&&!r.isUndefined(t)&&(this.dictionary.setValue(t,t),!0)},t.prototype.intersection=function(t){var e=this;this.forEach(function(n){return t.contains(n)||e.remove(n),!0})},t.prototype.union=function(t){var e=this;t.forEach(function(t){return e.add(t),!0})},t.prototype.difference=function(t){var e=this;t.forEach(function(t){return e.remove(t),!0})},t.prototype.isSubsetOf=function(t){if(this.size()>t.size())return!1;var e=!0;return this.forEach(function(n){return!!t.contains(n)||(e=!1,!1)}),e},t.prototype.remove=function(t){return!!this.contains(t)&&(this.dictionary.remove(t),!0)},t.prototype.forEach=function(t){this.dictionary.forEach(function(e,n){return t(n)})},t.prototype.toArray=function(){return this.dictionary.values()},t.prototype.isEmpty=function(){return this.dictionary.isEmpty()},t.prototype.size=function(){return this.dictionary.size()},t.prototype.clear=function(){this.dictionary.clear()},t.prototype.toString=function(){return o.toString(this.toArray())},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(8),o=function(){function t(){this.list=new r.default}return t.prototype.enqueue=function(t){return this.list.add(t)},t.prototype.add=function(t){return this.list.add(t)},t.prototype.dequeue=function(){if(0!==this.list.size()){var t=this.list.first();return this.list.removeElementAtIndex(0),t}},t.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.size()<=0},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=n(0),o=n(4),i=function(){function t(t){this.data=[],this.compare=t||r.defaultCompare}return t.prototype.leftChildIndex=function(t){return 2*t+1},t.prototype.rightChildIndex=function(t){return 2*t+2},t.prototype.parentIndex=function(t){return Math.floor((t-1)/2)},t.prototype.minIndex=function(t,e){return e>=this.data.length?t>=this.data.length?-1:t:this.compare(this.data[t],this.data[e])<=0?t:e},t.prototype.siftUp=function(t){for(var e=this.parentIndex(t);t>0&&this.compare(this.data[e],this.data[t])>0;)o.swap(this.data,e,t),t=e,e=this.parentIndex(t)},t.prototype.siftDown=function(t){for(var e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t));e>=0&&this.compare(this.data[t],this.data[e])>0;)o.swap(this.data,e,t),t=e,e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t))},t.prototype.peek=function(){return this.data.length>0?this.data[0]:void 0},t.prototype.add=function(t){if(!r.isUndefined(t))return this.data.push(t),this.siftUp(this.data.length-1),!0},t.prototype.removeRoot=function(){if(this.data.length>0){var t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),t}},t.prototype.contains=function(t){var e=r.compareToEquals(this.compare);return o.contains(this.data,t,e)},t.prototype.size=function(){return this.data.length},t.prototype.isEmpty=function(){return this.data.length<=0},t.prototype.clear=function(){this.data.length=0},t.prototype.forEach=function(t){o.forEach(this.data,t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o=n(1),i=function(){function t(t,e){this.f=r.Lambda2_toFunction(t),this.out=e,this.out.getVertex__().sources=this.out.getVertex__().sources.concat(r.toSources(r.Lambda2_deps(t))),this.accumValid=!1}return t.prototype.send_=function(t){var e=this;this.accumValid?this.accum=this.f(this.accum,t):(o.Transaction.currentTransaction.prioritized(this.out.getVertex__(),function(){e.out.send_(e.accum),e.accumValid=!1,e.accum=null}),this.accum=t,this.accumValid=!0)},t}();e.CoalesceHandler=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.f=t}return t.prototype.get=function(){return this.f()},t.prototype.map=function(e){var n=this;return new t(function(){return e(n.f())})},t.prototype.lift=function(e,n){var r=this;return new t(function(){return n(r.f(),e.f())})},t.prototype.lift3=function(e,n,r){var o=this;return new t(function(){return r(o.f(),e.f(),n.f())})},t.prototype.lift4=function(e,n,r,o){var i=this;return new t(function(){return o(i.f(),e.f(),n.f(),r.f())})},t}();e.Lazy=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(1),i=n(17),s=n(2),u=function(){function t(){}return t.updates=function(t){return t.getStream__()},t.value=function(e){return o.Transaction.run(function(){var n=new r.StreamWithSend;o.Transaction.currentTransaction.prioritized(n.getVertex__(),function(){n.send_(i.Unit.UNIT)});var s=n.snapshot1(e);return t.updates(e).orElse(s)})},t.defer=function(e){return t.split(e.map(function(t){return[t]}))},t.split=function(t){var e=new r.StreamWithSend(null);return e.setVertex__(new s.Vertex("split",0,[new s.Source(t.getVertex__(),function(){return t.listen_(e.getVertex__(),function(t){for(var n=0;n<t.length;n++)!function(n){o.Transaction.currentTransaction.post(n,function(){o.Transaction.run(function(){e.send_(t[n])})})}(n)},!1)})])),e},t}();e.Operational=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.UNIT=new t,t}();e.Unit=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),i=n(1),s=function(t){function e(e,n){var r=t.call(this,null,null)||this;return i.Transaction.run(function(){n&&r.setStream(n),r.lazyInitValue=e}),r}return r(e,t),e.prototype.sampleNoTrans__=function(){return null==this.value&&null!=this.lazyInitValue&&(this.value=this.lazyInitValue.get(),this.lazyInitValue=null),this.value},e}(o.Cell);e.LazyCell=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(14),s=n(1),u=function(t){function e(e){var n=t.call(this)||this;return e||(e=function(t,e){throw new Error("send() called more than once per transaction, which isn't allowed. Did you want to combine the events? Then pass a combining function to your StreamSink constructor.")}),n.coalescer=new i.CoalesceHandler(e,n),n}return r(e,t),e.prototype.send=function(t){var e=this;s.Transaction.run(function(){if(s.Transaction.currentTransaction.inCallback>0)throw new Error("You are not allowed to use send() inside a Sodium callback");e.coalescer.send_(t)})},e}(o.StreamWithSend);e.StreamSink=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),i=n(19),s=function(t){function e(e,n){return t.call(this,e,new i.StreamSink(n))||this}return r(e,t),e.prototype.send=function(t){this.getStream__().send(t)},e}(o.Cell);e.CellSink=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6);e.lambda1=r.lambda1,e.lambda2=r.lambda2,e.lambda3=r.lambda3,e.lambda4=r.lambda4,e.lambda5=r.lambda5,e.lambda6=r.lambda6;var o=n(3);e.Stream=o.Stream,e.StreamLoop=o.StreamLoop;var i=n(19);e.StreamSink=i.StreamSink;var s=n(7);e.Cell=s.Cell;var u=n(29);e.CellLoop=u.CellLoop;var a=n(20);e.CellSink=a.CellSink;var c=n(1);e.Transaction=c.Transaction;var l=n(30);e.Tuple2=l.Tuple2;var f=n(17);e.Unit=f.Unit;var p=n(16);e.Operational=p.Operational;var h=n(2);e.getTotalRegistrations=h.getTotalRegistrations,e.Vertex=h.Vertex;var d=n(9);e.TimerSystemImpl=d.TimerSystemImpl,e.TimerSystem=d.TimerSystem;var v=n(31);e.SecondsTimerSystem=v.SecondsTimerSystem;var y=n(32);e.MillisecondsTimerSystem=y.MillisecondsTimerSystem;var _=n(33);e.IOAction=_.IOAction},function(t,e,n){"use strict";var r=n(0),o=n(5),i=n(11),s=function(){function t(t){this.toStrF=t||r.defaultToString,this.dictionary=new o.default(this.toStrF),this.nElements=0}return t.prototype.add=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t))this.dictionary.getValue(t).copies+=e;else{var n={value:t,copies:e};this.dictionary.setValue(t,n)}return this.nElements+=e,!0},t.prototype.count=function(t){return this.contains(t)?this.dictionary.getValue(t).copies:0},t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.remove=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t)){var n=this.dictionary.getValue(t);return e>n.copies?this.nElements-=n.copies:this.nElements-=e,n.copies-=e,n.copies<=0&&this.dictionary.remove(t),!0}return!1},t.prototype.toArray=function(){for(var t=[],e=this.dictionary.values(),n=0,r=e;n<r.length;n++)for(var o=r[n],i=o.value,s=o.copies,u=0;u<s;u++)t.push(i);return t},t.prototype.toSet=function(){for(var t=new i.default(this.toStrF),e=this.dictionary.values(),n=0,r=e;n<r.length;n++){var o=r[n],s=o.value;t.add(s)}return t},t.prototype.forEach=function(t){this.dictionary.forEach(function(e,n){for(var r=n.value,o=n.copies,i=0;i<o;i++)if(!1===t(r))return!1;return!0})},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(0),o=n(12),i=function(){function t(t){this.root=null,this.compare=t||r.defaultCompare,this.nElements=0}return t.prototype.add=function(t){return!r.isUndefined(t)&&(null!==this.insertNode(this.createNode(t))&&(this.nElements++,!0))},t.prototype.clear=function(){this.root=null,this.nElements=0},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.size=function(){return this.nElements},t.prototype.contains=function(t){return!r.isUndefined(t)&&null!==this.searchNode(this.root,t)},t.prototype.remove=function(t){var e=this.searchNode(this.root,t);return null!==e&&(this.removeNode(e),this.nElements--,!0)},t.prototype.inorderTraversal=function(t){this.inorderTraversalAux(this.root,t,{stop:!1})},t.prototype.preorderTraversal=function(t){this.preorderTraversalAux(this.root,t,{stop:!1})},t.prototype.postorderTraversal=function(t){this.postorderTraversalAux(this.root,t,{stop:!1})},t.prototype.levelTraversal=function(t){this.levelTraversalAux(this.root,t)},t.prototype.minimum=function(){if(!this.isEmpty())return this.minimumAux(this.root).element},t.prototype.maximum=function(){if(!this.isEmpty())return this.maximumAux(this.root).element},t.prototype.forEach=function(t){this.inorderTraversal(t)},t.prototype.toArray=function(){var t=[];return this.inorderTraversal(function(e){return t.push(e),!0}),t},t.prototype.height=function(){return this.heightAux(this.root)},t.prototype.searchNode=function(t,e){for(var n=null;null!==t&&0!==n;)n=this.compare(e,t.element),n<0?t=t.leftCh:n>0&&(t=t.rightCh);return t},t.prototype.transplant=function(t,e){null===t.parent?this.root=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,null!==e&&(e.parent=t.parent)},t.prototype.removeNode=function(t){if(null===t.leftCh)this.transplant(t,t.rightCh);else if(null===t.rightCh)this.transplant(t,t.leftCh);else{var e=this.minimumAux(t.rightCh);e.parent!==t&&(this.transplant(e,e.rightCh),e.rightCh=t.rightCh,e.rightCh.parent=e),this.transplant(t,e),e.leftCh=t.leftCh,e.leftCh.parent=e}},t.prototype.inorderTraversalAux=function(t,e,n){null===t||n.stop||(this.inorderTraversalAux(t.leftCh,e,n),n.stop||(n.stop=!1===e(t.element),n.stop||this.inorderTraversalAux(t.rightCh,e,n)))},t.prototype.levelTraversalAux=function(t,e){var n=new o.default;for(null!==t&&n.enqueue(t);!n.isEmpty();){if(t=n.dequeue(),!1===e(t.element))return;null!==t.leftCh&&n.enqueue(t.leftCh),null!==t.rightCh&&n.enqueue(t.rightCh)}},t.prototype.preorderTraversalAux=function(t,e,n){null===t||n.stop||(n.stop=!1===e(t.element),n.stop||(this.preorderTraversalAux(t.leftCh,e,n),n.stop||this.preorderTraversalAux(t.rightCh,e,n)))},t.prototype.postorderTraversalAux=function(t,e,n){null===t||n.stop||(this.postorderTraversalAux(t.leftCh,e,n),n.stop||(this.postorderTraversalAux(t.rightCh,e,n),n.stop||(n.stop=!1===e(t.element))))},t.prototype.minimumAux=function(t){for(;null!==t.leftCh;)t=t.leftCh;return t},t.prototype.maximumAux=function(t){for(;null!==t.rightCh;)t=t.rightCh;return t},t.prototype.heightAux=function(t){return null===t?-1:Math.max(this.heightAux(t.leftCh),this.heightAux(t.rightCh))+1},t.prototype.insertNode=function(t){for(var e=null,n=this.root,r=null;null!==n;){if(0===(r=this.compare(t.element,n.element)))return null;r<0?(e=n,n=n.leftCh):(e=n,n=n.rightCh)}return t.parent=e,null===e?this.root=t:this.compare(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t},t.prototype.createNode=function(t){return{element:t,leftCh:null,rightCh:null,parent:null}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(5),i=n(0),s=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},t}(),u=function(t){function e(e){t.call(this,e),this.head=new s(null,null),this.tail=new s(null,null),this.head.next=this.tail,this.tail.prev=this.head}return r(e,t),e.prototype.appendToTail=function(t){var e=this.tail.prev;e.next=t,t.prev=e,t.next=this.tail,this.tail.prev=t},e.prototype.getLinkedDictionaryPair=function(t){if(!i.isUndefined(t)){var e="$"+this.toStr(t);return this.table[e]}},e.prototype.getValue=function(t){var e=this.getLinkedDictionaryPair(t);if(!i.isUndefined(e))return e.value},e.prototype.remove=function(e){var n=this.getLinkedDictionaryPair(e);if(!i.isUndefined(n))return t.prototype.remove.call(this,e),n.unlink(),n.value},e.prototype.clear=function(){t.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},e.prototype.replace=function(t,e){var n="$"+this.toStr(e.key);e.next=t.next,e.prev=t.prev,this.remove(t.key),e.prev.next=e,e.next.prev=e,this.table[n]=e,++this.nElements},e.prototype.setValue=function(t,e){if(!i.isUndefined(t)&&!i.isUndefined(e)){var n=this.getLinkedDictionaryPair(t),r=new s(t,e),o="$"+this.toStr(t);return i.isUndefined(n)?(this.appendToTail(r),this.table[o]=r,void++this.nElements):(this.replace(n,r),n.value)}},e.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(e)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},e.prototype.forEach=function(t){for(var e=this.head.next;null!=e.next;){if(!1===t(e.key,e.value))return;e=e.next}},e}(o.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,n){"use strict";var r=n(0),o=n(5),i=n(4),s=function(){function t(t,e,n){void 0===n&&(n=!1),this.dict=new o.default(t),this.equalsF=e||r.defaultEquals,this.allowDuplicate=n}return t.prototype.getValue=function(t){var e=this.dict.getValue(t);return r.isUndefined(e)?[]:i.copy(e)},t.prototype.setValue=function(t,e){if(r.isUndefined(t)||r.isUndefined(e))return!1;if(!this.containsKey(t))return this.dict.setValue(t,[e]),!0;var n=this.dict.getValue(t);return!(!this.allowDuplicate&&i.contains(n,e,this.equalsF))&&(n.push(e),!0)},t.prototype.remove=function(t,e){if(r.isUndefined(e)){var n=this.dict.remove(t);return!r.isUndefined(n)}var o=this.dict.getValue(t);return!!i.remove(o,e,this.equalsF)&&(0===o.length&&this.dict.remove(t),!0)},t.prototype.keys=function(){return this.dict.keys()},t.prototype.values=function(){for(var t=this.dict.values(),e=[],n=0,r=t;n<r.length;n++)for(var o=r[n],i=0,s=o;i<s.length;i++){var u=s[i];e.push(u)}return e},t.prototype.containsKey=function(t){return this.dict.containsKey(t)},t.prototype.clear=function(){this.dict.clear()},t.prototype.size=function(){return this.dict.size()},t.prototype.isEmpty=function(){return this.dict.isEmpty()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(0),o=n(13),i=function(){function t(t){this.heap=new o.default(r.reverseCompareFunction(t))}return t.prototype.enqueue=function(t){return this.heap.add(t)},t.prototype.add=function(t){return this.heap.add(t)},t.prototype.dequeue=function(){if(0!==this.heap.size()){var t=this.heap.peek();return this.heap.removeRoot(),t}},t.prototype.peek=function(){return this.heap.peek()},t.prototype.contains=function(t){return this.heap.contains(t)},t.prototype.isEmpty=function(){return this.heap.isEmpty()},t.prototype.size=function(){return this.heap.size()},t.prototype.clear=function(){this.heap.clear()},t.prototype.forEach=function(t){this.heap.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(8),o=function(){function t(){this.list=new r.default}return t.prototype.push=function(t){return this.list.add(t,0)},t.prototype.add=function(t){return this.list.add(t,0)},t.prototype.pop=function(){return this.list.removeElementAtIndex(0)},t.prototype.peek=function(){return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.isEmpty()},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.h=t,this.target=e}return t}();e.Listener=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(18),i=n(1),s=n(3),u=function(t){function e(){return t.call(this,null,new s.StreamLoop)||this}return r(e,t),e.prototype.loop=function(t){var e=this;i.Transaction.run(function(){e.getStream__().loop(t.getStream__()),e.lazyInitValue=t.sampleLazy()})},e.prototype.sampleNoTrans__=function(){if(!this.getStream__().assigned__)throw new Error("CellLoop sampled before it was looped");return t.prototype.sampleNoTrans__.call(this)},e}(o.LazyCell);e.CellLoop=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.a=t,this.b=e}return t}();e.Tuple2=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=function(t){function e(){return t.call(this,new s)||this}return r(e,t),e}(o.TimerSystem);e.SecondsTimerSystem=i;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setTimer=function(t,e){var n=setTimeout(e,Math.max(1e3*(t-this.now()),0));return function(){clearTimeout(n)}},e.prototype.now=function(){return.001*Date.now()},e}(o.TimerSystemImpl)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=function(t){function e(){return t.call(this,new s)||this}return r(e,t),e}(o.TimerSystem);e.MillisecondsTimerSystem=i;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setTimer=function(t,e){var n=setTimeout(e,Math.max(t-this.now(),0));return function(){clearTimeout(n)}},e.prototype.now=function(){return Date.now()},e}(o.TimerSystemImpl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(2),i=n(1),s=function(){function t(){}/*!
     * Convert a function that performs asynchronous I/O taking input A
     * and returning a value of type B into an I/O action of type
     * (sa : Stream<A>) => Stream<B>
     */
return t.fromAsync=function(t){return function(e){var n=new r.StreamWithSend(null);return n.setVertex__(new o.Vertex("map",0,[new o.Source(e.getVertex__(),function(){return e.listen_(n.getVertex__(),function(e){t(e,function(t){i.Transaction.run(function(){n.send_(t)})})},!1)})])),n}},t}();e.IOAction=s}])});
//# sourceMappingURL=sodium.umd.min.js.map